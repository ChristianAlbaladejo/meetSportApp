(window.webpackJsonp=window.webpackJsonp||[]).push([[101],{"ct+p":function(t,i,e){"use strict";e.r(i),e.d(i,"HomePageModule",(function(){return x}));var n=e("ofXK"),o=e("TEn/"),s=e("3Pt+"),c=e("tyNb"),l=e("mrSG"),r=e("qfBg"),a=e("MnDo"),b=e("wzbf"),u=e("tBOM"),h=e("dnnk"),p=e("ncJE"),d=e("fXoL");function g(t,i){if(1&t&&d.Kb(0,"img",20),2&t){const t=d.Wb().$implicit,i=d.Wb(2);d.cc("src",i.url+"/get-image-user/"+t.user.image,d.gc)}}function f(t,i){1&t&&d.Kb(0,"img",21)}function m(t,i){if(1&t){const t=d.Nb();d.Mb(0,"ion-button",16),d.Ub("click",(function(){d.fc(t);const i=d.Wb().$implicit;return d.Wb(2).like(i)})),d.kc(1,"Subscribe "),d.Lb()}}function M(t,i){if(1&t){const t=d.Nb();d.Mb(0,"ion-button",22),d.Ub("click",(function(){d.fc(t);const i=d.Wb().$implicit;return d.Wb(2).dislike(i)})),d.kc(1,"Unsubscribe "),d.Lb()}}function v(t,i){if(1&t){const t=d.Nb();d.Mb(0,"div",12),d.Mb(1,"ion-card"),d.Mb(2,"ion-item"),d.Mb(3,"ion-avatar",13),d.Ub("click",(function(){d.fc(t);const e=i.$implicit;return d.Wb(2).openUser(e.user)})),d.ic(4,g,1,1,"img",14),d.ic(5,f,1,0,"img",15),d.Lb(),d.Mb(6,"ion-label"),d.Mb(7,"h3"),d.kc(8),d.Xb(9,"date"),d.Lb(),d.Mb(10,"h3"),d.kc(11),d.Lb(),d.Mb(12,"h3"),d.kc(13),d.Xb(14,"date"),d.Lb(),d.Lb(),d.Lb(),d.Mb(15,"ion-card-content",16),d.Ub("click",(function(){d.fc(t);const e=i.$implicit,n=i.index,o=d.Wb(2);return o.openPublication(e,o.times[n])})),d.Kb(16,"div",17),d.Lb(),d.Mb(17,"ion-grid"),d.Mb(18,"ion-row"),d.Kb(19,"ion-col"),d.Mb(20,"ion-col"),d.ic(21,m,2,0,"ion-button",18),d.ic(22,M,2,0,"ion-button",19),d.Lb(),d.Kb(23,"ion-col"),d.Lb(),d.Lb(),d.Lb(),d.Lb()}if(2&t){const t=i.$implicit,e=i.index,n=d.Wb(2);d.zb(4),d.bc("ngIf",t.user.image),d.zb(1),d.bc("ngIf",!t.user.image),d.zb(3),d.nc("",(null==t?null:t.user.name)+" "+(null==t?null:t.user.surname)+" ","| \xa0",d.Yb(9,10," "+(null==t?null:t.created_at)),""),d.zb(3),d.lc(null==t?null:t.text),d.zb(2),d.nc("Date of exit: ",d.Yb(14,12,null==n.times[e]?null:n.times[e].date)," \xa0 ",null==n.times[e]?null:n.times[e].hour,""),d.zb(3),d.cc("id","map"+e),d.zb(5),d.bc("ngIf",!n.checkIfExists(t)),d.zb(1),d.bc("ngIf",n.checkIfExists(t))}}function k(t,i){1&t&&(d.Mb(0,"div",23),d.Mb(1,"strong"),d.kc(2,"You have no publications"),d.Lb(),d.Mb(3,"p"),d.kc(4,"You can create them or follow people to see them"),d.Lb(),d.Lb())}function _(t,i){if(1&t){const t=d.Nb();d.Mb(0,"div"),d.ic(1,v,24,14,"div",8),d.ic(2,k,5,0,"div",9),d.Mb(3,"ion-infinite-scroll",10),d.Ub("ionInfinite",(function(i){return d.fc(t),d.Wb().doInfinite(i)})),d.Kb(4,"ion-infinite-scroll-content",11),d.Lb(),d.Lb()}if(2&t){const t=d.Wb();d.zb(1),d.bc("ngForOf",t.publications),d.zb(1),d.bc("ngIf",0==t.publications.length)}}const y=[{path:"",component:(()=>{class t{constructor(t,i,e,n,o,s,c,l,r,a,b){this.menuCtrl=t,this.modalController=i,this._publicationService=e,this._route=n,this._router=o,this._userService=s,this.alert=c,this.loading=l,this.navCtrl=r,this._followService=a,this._googleMaps=b,this.page=1,this.coords=[],this.markers=[],this.maps=[],this.times=[],this.identity=this._userService.getIdentity(),this.token=this._userService.getToken(),this.url="https://api-meet-sport.herokuapp.com/api",console.log(this.identity._id)}ngOnInit(){this.getPublications(this.page)}ionViewWillEnter(){this.menuCtrl.enable(!0)}getPublications(t,i=!1){return Object(l.a)(this,void 0,void 0,(function*(){const e=yield this.loading.create();e.present(),this._publicationService.getPublications(this.token,t).subscribe(t=>{if(t.publications)if(this.coords=[],this.total=t.total_items,this.pages=t.pages,this.items_per_page=t.items_per_page,i){this.publications=this.publications.concat(t.publications),console.log(this.publications);for(let t=0;t<this.publications.length;t++){let i=this.publications[t].location.split(","),e=this.publications[t].date.split(","),n={date:e[0],hour:e[1]};this.coords.push({lat:i[0],lng:i[1],zoom:15}),this.times.push(n)}setTimeout(()=>{this.initialize(),e.dismiss()},3e3)}else{this.publications=t.publications;for(let t=0;t<this.publications.length;t++){let i=this.publications[t].location.split(","),e=this.publications[t].date.split(","),n={date:e[0],hour:e[1].substr(12).slice(0,5)};this.coords.push({lat:i[0],lng:i[1],zoom:15}),this.times.push(n)}setTimeout(()=>{this.initialize(),e.dismiss()},3e3)}else e.dismiss()},t=>Object(l.a)(this,void 0,void 0,(function*(){const t=yield this.alert.create({message:"Ohh! Something gone wrong. \u{1f625}",buttons:["OK"]});e.dismiss(),yield t.present()})))}))}delete(t){this._publicationService.deletePublication(this.token,t).subscribe(t=>{},t=>Object(l.a)(this,void 0,void 0,(function*(){const t=yield this.alert.create({message:"Ohh! Something gone wrong. \u{1f625}",buttons:["OK"]});yield t.present()})))}initialize(){for(var t=0,i=this.coords.length;t<i;t++){var e=this.coords[t],n=new google.maps.LatLng(e.lat,e.lng);this.maps[t]=new google.maps.Map(document.getElementById("map"+t),{zoom:e.zoom,center:n,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,gestureHandling:"none"}),this.markers[t]=new google.maps.Marker({position:n,map:this.maps[t]})}}addPublication(){this._router.navigate(["/add-publication"])}doInfinite(t){this.publications.length==this.total?t.target.complete():(this.page++,this.getPublications(this.page,!0).then(i=>t.target.complete()))}doRefresh(t){this.page=1,this.getPublications(this.page,!1).then(i=>t.target.complete())}openPublication(t,i){return Object(l.a)(this,void 0,void 0,(function*(){const e=yield this.modalController.create({component:h.a,componentProps:{publication:t,times:i}});return e.onDidDismiss().then(()=>{this.page=1,this.getPublications(this.page)}),yield e.present()}))}openUser(t){return Object(l.a)(this,void 0,void 0,(function*(){const i=yield this.modalController.create({component:p.a,componentProps:{user:t}});return yield i.present()}))}like(t){this.identity=this._userService.getIdentity(),this._publicationService.like(this.token,t).subscribe(i=>Object(l.a)(this,void 0,void 0,(function*(){if(i){for(let i=0;i<this.publications.length;i++)this.publications[i]._id==t._id&&(this.publications[i].like.push(this.identity._id),console.log(this.publications[i].like));console.log(this.identity._id)}else{const t=yield this.alert.create({message:"Ohh! Something gone wrong. \u{1f625}",buttons:["OK"]});yield t.present()}})),t=>Object(l.a)(this,void 0,void 0,(function*(){const t=yield this.alert.create({message:"Ohh! Something gone wrong. \u{1f625}",buttons:["OK"]});yield t.present()})))}dislike(t){this.identity=this._userService.getIdentity(),this._publicationService.dislike(this.token,t).subscribe(i=>Object(l.a)(this,void 0,void 0,(function*(){if(i){for(let i=0;i<this.publications.length;i++)if(this.publications[i]._id==t._id){var e=this.publications[i].like.indexOf(this.identity._id);this.publications[i].like.splice(e,1)}}else{const t=yield this.alert.create({message:"Ohh! Something gone wrong. \u{1f625}",buttons:["OK"]});yield t.present()}})),t=>Object(l.a)(this,void 0,void 0,(function*(){const t=yield this.alert.create({message:"Ohh! Something gone wrong. \u{1f625}",buttons:["OK"]});yield t.present()})))}checkIfExists(t){return!!t.like.includes(this.identity._id)}}return t.\u0275fac=function(i){return new(i||t)(d.Jb(o.M),d.Jb(o.N),d.Jb(b.a),d.Jb(c.a),d.Jb(c.g),d.Jb(r.a),d.Jb(o.a),d.Jb(o.L),d.Jb(o.O),d.Jb(a.a),d.Jb(u.a))},t.\u0275cmp=d.Db({type:t,selectors:[["app-home"]],features:[d.yb([r.a,a.a,b.a])],decls:13,vars:2,consts:[["color","success"],["slot","start"],[3,"fullscreen"],["slot","fixed","pullFactor","0.5","pullMin","100","pullMax","200",3,"ionRefresh"],[4,"ngIf"],["horizontal","end","vertical","bottom","slot","fixed",3,"click"],["color","medium"],["name","add"],["id","container",4,"ngFor","ngForOf"],["id","container-no-exits",4,"ngIf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Loading more data..."],["id","container"],["slot","start",3,"click"],[3,"src",4,"ngIf"],["src","../../assets/no-user.webp",4,"ngIf"],[3,"click"],[2,"max-width","500px","height","300px",3,"id"],[3,"click",4,"ngIf"],["style","color:white","color","warning",3,"click",4,"ngIf"],[3,"src"],["src","../../assets/no-user.webp"],["color","warning",2,"color","white",3,"click"],["id","container-no-exits"]],template:function(t,i){1&t&&(d.Mb(0,"ion-header"),d.Mb(1,"ion-toolbar",0),d.Mb(2,"ion-buttons",1),d.Kb(3,"ion-menu-button"),d.Lb(),d.Mb(4,"ion-title"),d.kc(5," Home "),d.Lb(),d.Lb(),d.Lb(),d.Mb(6,"ion-content",2),d.Mb(7,"ion-refresher",3),d.Ub("ionRefresh",(function(t){return i.doRefresh(t)})),d.Kb(8,"ion-refresher-content"),d.Lb(),d.ic(9,_,5,2,"div",4),d.Mb(10,"ion-fab",5),d.Ub("click",(function(){return i.addPublication()})),d.Mb(11,"ion-fab-button",6),d.Kb(12,"ion-icon",7),d.Lb(),d.Lb(),d.Lb()),2&t&&(d.zb(6),d.bc("fullscreen",!0),d.zb(3),d.bc("ngIf",i.publications))},directives:[o.o,o.I,o.e,o.y,o.H,o.j,o.A,o.B,n.j,o.l,o.m,o.p,n.i,o.q,o.r,o.f,o.t,o.c,o.u,o.g,o.n,o.D,o.i,o.d],pipes:[n.d],styles:["#container[_ngcontent-%COMP%]{max-width:500px;margin:auto}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}#container-no-exits[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container-no-exits[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container-no-exits[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}"]}),t})()}];let O=(()=>{class t{}return t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({factory:function(i){return new(i||t)},imports:[[c.i.forChild(y)],c.i]}),t})(),x=(()=>{class t{}return t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({factory:function(i){return new(i||t)},imports:[[n.b,s.a,o.J,O]]}),t})()}}]);